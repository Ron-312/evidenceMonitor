<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extension Surveillance Detection Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .test-section h2 {
            color: #d32f2f;
            border-bottom: 2px solid #d32f2f;
            padding-bottom: 10px;
        }

        .test-form {
            display: grid;
            gap: 15px;
            max-width: 500px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-weight: bold;
        }

        input,
        select,
        textarea {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }

        button {
            background-color: #d32f2f;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }

        button:hover {
            background-color: #b71c1c;
        }

        .malicious-button {
            background-color: #ff6b35;
        }

        .malicious-button:hover {
            background-color: #e5501f;
        }

        .console-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            margin-top: 15px;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
        }

        .iframe-container {
            border: 2px solid #d32f2f;
            border-radius: 8px;
            margin: 15px 0;
        }

        .iframe-test {
            width: 100%;
            height: 400px;
            border: none;
            border-radius: 6px;
        }
    </style>
</head>

<body>
    <h1>üïµÔ∏è Surveillance Detection Extension Test Page</h1>
    <p><strong>Instructions:</strong> This page simulates malicious JavaScript behaviors to test your extension's surveillance detection capabilities. Click the red "Simulate Attack" buttons to trigger each hook type.</p>

    <!-- Test Section 1: addEventListener Hook -->
    <div class="test-section">
        <h2>1. addEventListener Hook Test</h2>
        <p>Tests detection of malicious scripts adding event listeners to form elements.</p>

        <form class="test-form" id="addEventListener-form">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" placeholder="Type here to test...">
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" placeholder="Type here to test...">
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" placeholder="Type here to test...">
            </div>
            <div class="form-group">
                <label for="country">Country:</label>
                <select id="country" name="country">
                    <option value="">Select country...</option>
                    <option value="us">United States</option>
                    <option value="ca">Canada</option>
                    <option value="uk">United Kingdom</option>
                </select>
            </div>
            <div class="form-group">
                <label for="comments">Comments:</label>
                <textarea id="comments" name="comments" rows="3" placeholder="Enter comments..."></textarea>
            </div>
        </form>

        <div>
            <button class="malicious-button" id="btn-addEventListener-attack">
                üö® Simulate addEventListener Attack
            </button>
            <button id="btn-addEventListener-clear">Clear Console</button>
        </div>

        <div class="console-output" id="addEventListener-console">
            Console output will appear here...
        </div>
    </div>

    <!-- Test Section 2: Event Handler Hooks -->
    <div class="test-section">
        <h2>2. Event Handler Hooks Test</h2>
        <p>Tests detection of malicious scripts setting event handler properties (onclick, oninput, etc.).</p>

        <form class="test-form" id="eventHandler-form">
            <div class="form-group">
                <label for="creditCard">Credit Card:</label>
                <input type="text" id="creditCard" name="creditCard" placeholder="Enter credit card number...">
            </div>
            <div class="form-group">
                <label for="ssn">SSN:</label>
                <input type="text" id="ssn" name="ssn" placeholder="Enter SSN...">
            </div>
            <div class="form-group">
                <label for="bankAccount">Bank Account:</label>
                <input type="text" id="bankAccount" name="bankAccount" placeholder="Enter account number...">
            </div>
            <div class="form-group">
                <label for="securityCode">Security Code:</label>
                <input type="password" id="securityCode" name="securityCode" placeholder="Enter security code...">
            </div>
            <div class="form-group">
                <label for="phoneNumber">Phone:</label>
                <select id="phoneNumber" name="phoneNumber">
                    <option value="">Select phone...</option>
                    <option value="mobile">Mobile</option>
                    <option value="home">Home</option>
                    <option value="work">Work</option>
                </select>
            </div>
        </form>

        <div>
            <button class="malicious-button" id="btn-eventHandler-attack">
                üö® Simulate Event Handler Attack
            </button>
            <button id="btn-eventHandler-clear">Clear Console</button>
        </div>

        <div class="console-output" id="eventHandler-console">
            Console output will appear here...
        </div>
    </div>

    <!-- Test Section 3: Property Getter Hooks -->
    <div class="test-section">
        <h2>3. Property Getter Hooks Test</h2>
        <p>Tests detection of malicious scripts accessing form element values/properties.</p>

        <form class="test-form" id="propertyGetter-form">
            <div class="form-group">
                <label for="sensitiveData">Sensitive Data:</label>
                <input type="text" id="sensitiveData" name="sensitiveData" placeholder="Enter sensitive information..." value="secret123">
            </div>
            <div class="form-group">
                <label for="personalInfo">Personal Info:</label>
                <input type="text" id="personalInfo" name="personalInfo" placeholder="Enter personal info..." value="John Doe">
            </div>
            <div class="form-group">
                <label for="financialData">Financial Data:</label>
                <input type="password" id="financialData" name="financialData" placeholder="Enter financial data..." value="account456">
            </div>
            <div class="form-group">
                <label for="privateNotes">Private Notes:</label>
                <textarea id="privateNotes" name="privateNotes" rows="3" placeholder="Private notes...">These are my private notes</textarea>
            </div>
            <div class="form-group">
                <label for="securityLevel">Security Level:</label>
                <select id="securityLevel" name="securityLevel">
                    <option value="low">Low</option>
                    <option value="medium" selected>Medium</option>
                    <option value="high">High</option>
                </select>
            </div>
        </form>

        <div>
            <button class="malicious-button" id="btn-propertyGetter-attack">
                üö® Simulate Property Access Attack
            </button>
            <button id="btn-propertyGetter-clear">Clear Console</button>
        </div>

        <div class="console-output" id="propertyGetter-console">
            Console output will appear here...
        </div>
    </div>

    <!-- Test Section 4: Form Hooks -->
    <div class="test-section">
        <h2>4. Form Hooks Test</h2>
        <p>Tests detection of malicious scripts intercepting form submissions and FormData creation.</p>

        <form class="test-form" id="formHooks-form" action="/submit" method="POST">
            <div class="form-group">
                <label for="loginUsername">Login Username:</label>
                <input type="text" id="loginUsername" name="loginUsername" placeholder="Enter username..." value="testuser">
            </div>
            <div class="form-group">
                <label for="loginPassword">Login Password:</label>
                <input type="password" id="loginPassword" name="loginPassword" placeholder="Enter password..." value="testpass123">
            </div>
            <div class="form-group">
                <label for="apiKey">API Key:</label>
                <input type="text" id="apiKey" name="apiKey" placeholder="Enter API key..." value="sk_test_12345">
            </div>
            <div class="form-group">
                <label for="secretToken">Secret Token:</label>
                <input type="password" id="secretToken" name="secretToken" placeholder="Enter token..." value="token_abcdef">
            </div>
            <div class="form-group">
                <label for="userRole">User Role:</label>
                <select id="userRole" name="userRole">
                    <option value="user">User</option>
                    <option value="admin" selected>Admin</option>
                    <option value="superuser">Super User</option>
                </select>
            </div>
            <div class="form-group">
                <button type="button" id="btn-form-submit-event">üö® Simulate Submit Event</button>
                <button type="submit" id="btn-form-submit-safe">Submit Form (Safe)</button>
            </div>
        </form>

        <div>
            <button class="malicious-button" id="btn-formHooks-attack">
                üö® Simulate Form Data Attack
            </button>
            <button class="malicious-button" id="btn-formSubmit-attack">
                üö® Simulate Form Submit Attack
            </button>
            <button id="btn-formHooks-clear">Clear Console</button>
        </div>

        <div class="console-output" id="formHooks-console">
            Console output will appear here...
        </div>
    </div>

    <!-- Test Section 5: Iframe Test -->
    <div class="test-section">
        <h2>5. Iframe Test</h2>
        <p>Tests surveillance detection within iframes containing forms.</p>

        <div class="iframe-container">
            <iframe id="test-iframe" class="iframe-test"></iframe>
        </div>

        <div class="console-output" id="iframe-console">
            Iframe messages will appear here...
        </div>
    </div>

    <!-- Test Section 6: Cross-Frame Attack Test -->
    <div class="test-section">
        <h2>6. Cross-Frame Attack Test</h2>
        <p>Tests detection of malicious iframe scripts attempting to access parent frame elements.</p>

        <form class="test-form" id="main-frame-form">
            <div class="form-group">
                <label for="mainFramePassword">Main Frame Password (Target):</label>
                <input type="password" id="mainFramePassword" name="mainPassword" placeholder="Target for cross-frame attack..." value="secret123">
            </div>
            <div class="form-group">
                <label for="mainFrameUsername">Main Frame Username (Target):</label>
                <input type="text" id="mainFrameUsername" name="mainUsername" placeholder="Another target..." value="admin@bank.com">
            </div>
            <div class="form-group">
                <label for="mainFrameSSN">Main Frame SSN (Target):</label>
                <input type="text" id="mainFrameSSN" name="mainSSN" placeholder="Sensitive data target..." value="123-45-6789">
            </div>
        </form>

        <div class="iframe-container">
            <iframe id="cross-frame-attacker" class="iframe-test"></iframe>
        </div>

        <div>
            <button id="btn-crossFrame-clear">Clear Console</button>
        </div>

        <div class="console-output" id="cross-frame-console">
            Cross-frame attack attempts and results will appear here...
        </div>
    </div>

    <!-- Load JavaScript files -->
    <script src="js/utils.js"></script>
    <script src="js/attack-simulations.js"></script>
    <script src="js/iframe-handlers.js"></script>
    <script src="js/main.js"></script>
</body>

</html>